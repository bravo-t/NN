Comparing H_before_relu
Difference of the two matrixes are 0.000000
Comparing H_after_relu
Difference of the two matrixes are 0.000000
Comparing self H after relu
Difference of the two matrixes are 0.000000
Comparing softmax score
Difference of the two matrixes are 0.000000
Comparing softmax loss and dscore
score = 
Height of matrix: 9, width: 3
0.000000	0.000000	0.000000	
-0.000077	0.000041	0.000010	
-0.000094	0.000050	0.000012	
0.000000	0.000000	0.000000	
0.000016	-0.000041	-0.000028	
-0.000072	0.000033	0.000005	
0.000000	0.000000	0.000000	
-0.000050	0.000027	0.000006	
0.000021	-0.000052	-0.000035	
max_scores = 
Height of matrix: 9, width: 1
0.000000	
-0.000104	
-0.000127	
0.000000	
-0.000036	
-0.000107	
0.000000	
-0.000068	
-0.000045	
shifted = 
Height of matrix: 9, width: 3
0.000000	0.000000	0.000000	
0.000027	0.000145	0.000114	
0.000032	0.000177	0.000139	
0.000000	0.000000	0.000000	
0.000052	-0.000005	0.000008	
0.000034	0.000140	0.000111	
0.000000	0.000000	0.000000	
0.000017	0.000095	0.000074	
0.000066	-0.000007	0.000010	
exp_score = 
Height of matrix: 9, width: 3
1.000000	1.000000	1.000000	
1.000027	1.000145	1.000113	
1.000032	1.000177	1.000139	
1.000000	1.000000	1.000000	
1.000052	0.999995	1.000008	
1.000034	1.000140	1.000111	
1.000000	1.000000	1.000000	
1.000017	1.000095	1.000074	
1.000066	0.999994	1.000010	
exp_sum = 
Height of matrix: 9, width: 1
1.000000	
1.000145	
1.000177	
1.000000	
1.000052	
1.000140	
1.000000	
1.000095	
1.000066	
probs = 
Height of matrix: 9, width: 3
1.000000	1.000000	1.000000	
0.999882	1.000000	0.999969	
0.999855	1.000000	0.999962	
1.000000	1.000000	1.000000	
1.000000	0.999943	0.999956	
0.999895	1.000000	0.999972	
1.000000	1.000000	1.000000	
0.999923	1.000000	0.999979	
1.000000	0.999928	0.999944	
correct_probs = 
Height of matrix: 9, width: 1
-0.000000	
0.000118	
0.000145	
-0.000000	
0.000057	
-0.000000	
-0.000000	
0.000021	
0.000056	
Expecting data loss: 1.098627, got 0.000044
ERROR: Difference between ref and impl is too big: 17.999208
ref = 
Height of matrix: 9, width: 3
-0.074074	0.037037	0.037037	
-0.074077	0.037039	0.037038	
-0.074077	0.037039	0.037038	
0.037037	-0.074074	0.037037	
0.037038	-0.074075	0.037037	
0.037035	-0.074072	0.037038	
0.037037	0.037037	-0.074074	
0.037035	0.037038	-0.074074	
0.037039	0.037036	-0.074075	
impl = 
Height of matrix: 9, width: 3
0.000000	1.000000	1.000000	
-0.000118	1.000000	0.999969	
-0.000145	1.000000	0.999962	
1.000000	0.000000	1.000000	
1.000000	-0.000057	0.999956	
0.999895	0.000000	0.999972	
1.000000	1.000000	0.000000	
0.999923	1.000000	-0.000021	
1.000000	0.999928	-0.000056	
Expecting reg loss: 0.000001, got 0.000001
Comparing dH_before_relu
ERROR: Difference between ref and impl is too big: 0.020283
ref = 
Height of matrix: 9, width: 2
-0.002162	0.001223	
-0.002162	0.001223	
-0.002162	0.001223	
0.001496	-0.000892	
0.001496	-0.000892	
0.001496	-0.000892	
0.000666	-0.000330	
0.000666	-0.000330	
0.000666	-0.000330	
impl = 
Height of matrix: 9, width: 2
0.000000	0.000004	
0.000000	0.000004	
0.000000	0.000004	
0.000000	-0.000007	
0.000000	-0.000007	
0.000000	-0.000007	
-0.000000	0.000003	
-0.000000	0.000003	
-0.000000	0.000003	
Comparing dW2
ERROR: Difference between ref and impl is too big: 0.001612
ref = 
Height of matrix: 2, width: 3
0.000157	-0.000069	-0.000088	
-0.000650	0.000215	0.000435	
impl = 
Height of matrix: 2, width: 3
0.000000	0.000000	0.000000	
0.000000	0.000000	0.000000	
Comparing dH_after_relu
ERROR: Difference between ref and impl is too big: 0.012981
ref = 
Height of matrix: 9, width: 2
0.000000	0.000000	
0.000000	0.001223	
0.000000	0.001223	
0.000000	0.000000	
0.001496	0.000000	
0.001496	-0.000892	
0.000000	0.000000	
0.000000	-0.000330	
0.000666	0.000000	
impl = 
Height of matrix: 9, width: 2
-0.002162	0.001223	
-0.002162	0.001223	
-0.002162	0.001223	
0.001496	-0.000892	
0.001496	-0.000892	
0.001496	-0.000892	
0.000666	-0.000330	
0.000666	-0.000330	
0.000666	-0.000330	
Comparing self dH
ERROR: Difference between ref and impl is too big: 0.012981
ref = 
Height of matrix: 9, width: 2
0.000000	0.000000	
0.000000	0.001223	
0.000000